From 3058bab46a95233db70587411f112a015aca7e85 Mon Sep 17 00:00:00 2001
From: Bartosz Brachaczek <b.brachaczek@gmail.com>
Date: Wed, 28 Dec 2011 01:49:33 +0100
Subject: [PATCH] build: Fix linking to ntrack if manually specified in
 NETWORK_IMPLEMANTATION

Signed-off-by: Bartosz Brachaczek <b.brachaczek@gmail.com>
---
 kadu-core/CMakeLists.txt         |    3 +++
 kadu-core/network/CMakeLists.txt |    3 ---
 2 files changed, 3 insertions(+), 3 deletions(-)

diff --git a/kadu-core/CMakeLists.txt b/kadu-core/CMakeLists.txt
index 28091d8..5384211 100644
--- a/kadu-core/CMakeLists.txt
+++ b/kadu-core/CMakeLists.txt
@@ -34,6 +34,9 @@ if (NOT NETWORK_IMPLEMENTATION)
 		set (NETWORK_IMPLEMENTATION "Qt" CACHE STRING "Select network-aware implementation (Qt/ntrack/dummy)" FORCE)
 		message (STATUS "No NETWORK_IMPLEMENTATION defined. Autodetected implementation: Qt")
 	endif (QNTRACK_FOUND)
+elseif (${NETWORK_IMPLEMENTATION} STREQUAL "ntrack")
+	set (QNtrack_FIND_REQUIRED true)
+	include (FindQNtrack)
 endif (NOT NETWORK_IMPLEMENTATION)
 
 set (kadu_SRCS
diff --git a/kadu-core/network/CMakeLists.txt b/kadu-core/network/CMakeLists.txt
index 961936c..170d8a2 100644
--- a/kadu-core/network/CMakeLists.txt
+++ b/kadu-core/network/CMakeLists.txt
@@ -37,9 +37,6 @@ elseif (${NETWORK_IMPLEMENTATION} STREQUAL "ntrack")
 	set (NETWORK_IMPLEMENTATION_INCLUDE network-manager-ntrack.h)
 	set (NETWORK_IMPLEMENTATION_CLASS_NAME NetworkManagerNTrack)
 
-	set (QNtrack_FIND_REQUIRED true)
-
-	include ("../../cmake/FindQNtrack.cmake")
 	include_directories (${QNTRACK_INCLUDE_DIR})
 
 	set (network_SRCS ${network_SRCS}
-- 
1.7.6

